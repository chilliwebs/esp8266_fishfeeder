const char *FISH_SVG = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><svg version=\"1.1\" viewBox=\"0 0 113.30518 75.815407\" xmlns=\"http://www.w3.org/2000/svg\"><g transform=\"translate(-35.48 -121.14)\"><path d=\"m129.89 161.36a36.081 30.87 0 0 1 -36.081 30.87 36.081 30.87 0 0 1 -36.081 -30.87 36.081 30.87 0 0 1 36.081 -30.87 36.081 30.87 0 0 1 36.081 30.87z\" fill=\"#f38838\" stroke-width=\".26471\"/><path d=\"m129.89 161.36c-1e-5 17.049-16.154 30.87-36.081 30.87s-36.081-13.821-36.081-30.87c-1e-6 -17.049 16.421-28.598 36.349-28.598 19.927 0 35.814 11.549 35.814 28.598z\" fill=\"#ffa35a\" stroke-width=\".26471\"/><path d=\"m85.393 132.76c-2.8037-5.0362-7.9528-8.128-12.829-11.092 13.186-1.9654 21.559 2.6338 25.123 11.359z\" fill=\"#f38838\"/><path d=\"m97.687 133.03c-2.9531-8.8761-10.509-11.136-19.11-11.893 5.1177 3.8403 10.686 7.5576 12.027 12.428z\" fill=\"#ffa35a\"/><path d=\"m79.266 138.92c14.24-2.7549 28.322-4.1103 43.866 10.357-10.135-13.583-23.69-17.13-43.866-10.357z\" fill=\"#feb783\"/><path d=\"m117.18 182.03c-13.852 6.1849-38.727 8.4908-54.638-9.2228 11.076 16.652 36.35 22.149 54.638 9.2228z\" fill=\"#feb783\"/><path d=\"m80.582 189.16c-3.2793 2.2528-7.1046 3.6865-11.092 4.8777 10.542 4.842 17.999 3.0384 23.921-2.0713z\" fill=\"#ffa35a\"/><path d=\"m83.968 190.8c-4.4143 3.7344-8.937 3.2848-12.604 4.0907 10.328 3.8844 16.292 1.8892 21.716-2.6639-3.2808-0.29866-6.7121-0.68741-9.1115-1.4268z\" fill=\"#f2883a\"/><path d=\"m58.198 155.95-22.718-10.357 7.4835 17.64-5.0113 18.241 20.914-13.029z\" fill=\"#f2883a\"/><path d=\"m58.652 156.14-17.422-7.9188 9.7513 14.342-8.7767 16.268 16.661-10.388z\" fill=\"#ffa35a\"/><ellipse cx=\"141.89\" cy=\"145.22\" rx=\"6.8985\" ry=\"6.9653\" fill=\"#32c9d0\"/><ellipse cx=\"136.57\" cy=\"157.72\" rx=\"4.2832\" ry=\"4.2498\" fill=\"#32c9d0\"/><ellipse cx=\"131.76\" cy=\"136.04\" rx=\"4.2832\" ry=\"4.2498\" fill=\"#32c9d0\"/><ellipse cx=\"131.7\" cy=\"135.44\" rx=\"2.9469\" ry=\"2.9135\" fill=\"#fefefe\"/><ellipse cx=\"141.35\" cy=\"145.46\" rx=\"4.5171\" ry=\"4.5171\" fill=\"#fefefe\"/><ellipse cx=\"137.08\" cy=\"157.15\" rx=\"2.7464\" ry=\"2.7799\" fill=\"#fefefe\"/><ellipse cx=\"93.544\" cy=\"159.22\" rx=\"8.0915\" ry=\"8.0581\" fill=\"#fefefe\"/><ellipse cx=\"119.6\" cy=\"158.96\" rx=\"8.0915\" ry=\"8.0581\" fill=\"#fefefe\"/><ellipse cx=\"94.221\" cy=\"157.45\" rx=\"5.0928\" ry=\"5.3578\" fill=\"#8d6146\"/><ellipse cx=\"118.99\" cy=\"157.22\" rx=\"5.2932\" ry=\"5.2576\" fill=\"#8d6146\"/><ellipse cx=\"95.916\" cy=\"153.88\" rx=\"1.9101\" ry=\"1.9101\" fill=\"#fefefe\"/><ellipse cx=\"118.07\" cy=\"153.68\" rx=\"1.9101\" ry=\"1.9101\" fill=\"#fefefe\"/><path d=\"m102.03 169.79c0.67932 5.4726 8.5121 5.5249 9.0872 0\" fill=\"none\" stroke=\"#8d6144\" stroke-width=\".565\"/></g></svg>";

const char *CSS = R"(*,*::before,*::after{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:#000}@at-root{@-ms-viewport{width:device-width}}article,aside,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}body{margin:0;text-align:left;}[tabindex='-1']:focus{outline:0!important}hr{box-sizing:content-box;height:0;overflow:visible}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:0;}p{margin-top:0;}ol,ul,dl{margin-top:0;margin-bottom:1rem}ol ol,ul ul,ol ul,ul ol{margin-bottom:0}a{background-color:transparent;}a:not([href]):not([tabindex]){color:inherit;text-decoration:none;@include hover-focus{color:inherit;text-decoration:none}&:focus{outline:0}}img{vertical-align:middle;border-style:none}svg{overflow:hidden;vertical-align:middle}table{border-collapse:collapse}th{text-align:inherit}label{display:inline-block;}button{border-radius:0}button:focus{outline:1px dotted;outline:5px auto-webkit-focus-ring-color}input,button,select,optgroup,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,input{overflow:visible}button,select{text-transform:none}button,[type='button'],[type='reset'],[type='submit']{-webkit-appearance:button}button::-moz-focus-inner,[type='button']::-moz-focus-inner,[type='reset']::-moz-focus-inner,[type='submit']::-moz-focus-inner{padding:0;border-style:none}input[type='radio'],input[type='checkbox']{box-sizing:border-box;padding:0}input[type='date'],input[type='time'],input[type='datetime-local'],input[type='month']{-webkit-appearance:listbox}textarea{overflow:auto;resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{display:block;width:100%;max-width:100%;padding:0;margin-bottom:.5rem;font-size:1.5rem;line-height:inherit;color:inherit;white-space:normal}progress{vertical-align:baseline}[type='number']::-webkit-inner-spin-button,[type='number']::-webkit-outer-spin-button{height:auto}[type='search']{outline-offset:-2px;-webkit-appearance:none}template{display:none}[hidden]{display:none!important}
*{color:#096298;}
html,body{width:100%;height:100%;background:-moz-linear-gradient(top,#b2e1ff 0%,#66b6fc 100%);background:-webkit-linear-gradient(top,#b2e1ff 0%,#66b6fc 100%);background:linear-gradient(to bottom,#b2e1ff 0%,#66b6fc 100%);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#b2e1ff',endColorstr='#66b6fc',GradientType=0);}
hr{border: solid #096298 1px}
header,section{padding:1em;}
section{padding-top:0;}
header h1 {margin-left:2.125em;}
#currenttime{position:absolute;top:1em;right:1em;}
#uptime{position:absolute;top:2em;right:1em;}
#fishicon{position:absolute;top:0;left:1em;width:4em;height:4em;})";

const char *JS = R"(function id(eid){return document.getElementById(eid);}
function ajax(url,method,success,fail){
  if(!method)method='GET';
  var xhr=new XMLHttpRequest();xhr.open(method,url);xhr.onload=function(){if(xhr.status===200&&success!=null){success(xhr.responseText)}else if(fail!=null){fail(xhr.status)}};xhr.send();}
  function UTCtoLOC(d){
  return new Date(d.getTime()+(new Date().getTimezoneOffset()*60*1000));
}
function fmt(d){
  var dow=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  var mon=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  return dow[d.getDay()]+', '+d.getDate()+' '+mon[d.getMonth()]+' '+d.getFullYear()+' '+(d.getHours()<10?'0':'')+(((d.getHours()+11)%12)+1)+':'+(d.getMinutes()<10?'0':'')+d.getMinutes()+' '+(d.getHours()/12>=1?'pm':'am');
}
function getDifference(d1,d2){
  var ms=((new Date(d1))-(new Date(d2)));
  var days=Math.floor(ms/(24*60*60*1000));
  var hours=Math.floor((ms-(days*24*60*60*1000))/(60*60*1000));
  var minutes=Math.floor((ms-((days*24*60*60*1000)+(hours*60*60*1000)))/(60*1000));
  return(((days+hours+minutes==0)?'a few seconds':'')+(days>0?(days+' days '):'')+(hours>0?(hours+' hours '):'')+(minutes>0?(minutes+' minutes '):'')).trim();
}
function getScheduleData(){
  var days1=Array.prototype.reduce.call(document.querySelectorAll('input[name=\'days1[]\']:checked'),function(accumulator,currentValue){
    return accumulator+parseInt(currentValue.value);
  },0);
  var time1_parts=id('time1').value.split(':');
  var time1=((parseInt(time1_parts[0])*60)+parseInt(time1_parts[1]));
  return[days1,((1440+time1+new Date().getTimezoneOffset())%1440)];
}
function save_config(){
  var ssid=id('ssid').value;
  var password=id('password').value;
  ajax('save?ssid='+ssid+'&password='+password,'GET', function(){id('config').style.display='none';});
}
function save(){
  var data=getScheduleData();
  ajax('save?days1='+data[0]+'&time1='+data[1],'GET',function(responseText){updateinfo(true)});
}
function updateinfo(update_schedule){
  ajax('info','GET',function(responseText){
    var info=JSON.parse(responseText);
    var on=new Date(info['on']*1000);
    var now=new Date(info['now']*1000);
    id('uptime').innerHTML='uptime: '+getDifference(now,on);
    id('currenttime').innerHTML=fmt(new Date());
   if(info['apmode']==1){
      id('config').style.display='block';
      id('feeding').style.display='none';
   } else {
      id('config').style.display='none';
      id('feeding').style.display='block';
      var next=new Date(info['next']*1000);
      var last=new Date(info['last']*1000);
      id('count').innerHTML=info['count'];
      id('next').innerHTML=fmt(next)+' (in '+getDifference(next,now)+')';
      id('last').innerHTML=fmt(last)+' ('+getDifference(now,last)+' ago)';
      if(update_schedule){
        var days1Flags=info['days1'];
        var days1=document.querySelectorAll('input[name=\'days1[]\']');
        for(var n=6;n>=0;n--){
          var flag=parseInt(days1[n].value);
          if(days1Flags>=flag){
            days1[n].checked=true;
            days1Flags=days1Flags-flag;
          }else{
            days1[n].checked=false;
          }
        }
        var time1=(1440+(info['time1']-(new Date().getTimezoneOffset())))%1440;
        var hours=Math.floor(time1/(60));
        var minutes=Math.floor(time1-(hours*60));
        id('time1').value=(hours<10?'0':'')+hours+':'+(minutes<10?'0':'')+minutes;
      }
    }
  });
}
window.onload=function(){
  updateinfo(true);
  setInterval(updateinfo,30000);
})";

const char *TMP1 = "<!DOCTYPE HTML><html><head><title>";
const char *TMP2 = R"(</title>
<link href="style.css" type="text/css" rel="stylesheet"></link>
<script src="script.js"></script></head><body>)";
const char *TMP3 = "</body></html>";

const char *page_template(const char *title, const char *content) {
  std::string s = TMP1;
  return (s + title + TMP2 + content + TMP3).c_str();
}
